
<%= render layout: 'layouts/user_simple' do%>
  <div class="row">
    <div class="four columns">
      <dl class="sub-nav">
        <dt>Filter:</dt>
        <%= nav_link 'Confirmed', friendships_path(filter: :confirmed) %>
        <%= nav_link 'Received', friendships_path(filter: :received) %>
        <%= nav_link 'Requested', friendships_path(filter: :requested) %>
        <%= nav_link 'Ignored', friendships_path(filter: :ignored) %>
      </dl>
    </div>
  </div>
  <div class="twelve columns">

    <table class="friends">
      <thead>
        <tr>
          <th></th>
          <th>Username</th>
          <th><%= icon_for :watched %>
          <th><%= icon_for :loved %>
          <th><%= icon_for :owned %>
          <th><%= icon_for :list %>
          <th>Rating</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @friendships.each do |friendship| %>
          <tr>
            <td>
              <%= link_to user_path(friendship.friend) do %>
                <%= avatar friendship.friend, 'small' %>
               <% end %>
            </td>
            <td>
              <%= link_to friendship.friend.username, user_path(friendship.friend) %>
            </td>
            <% [:watched, :loved, :owned].each do |action| %>
              <td>
                <%= link_to user_film_path(friendship.friend, action) do %>
                  <label style="display:inline"><%= friendship.friend.actions_for(action).count %> </label>
                 <% end %>              
              </td>   
            <% end %> 
            <td>
              <%= link_to user_lists_path(friendship.friend) do %>
                <label> <%=friendship.friend.films_lists.viewable.count %> </label>
              <% end %>
            </td>    
            <td>
             <%= number_to_percentage(current_user.compare_to(friendship.friend).overall, precision: 1) %>
            </td>
            <td>
              <%= render partial: "friendships/#{friendship.state}", locals: {friend: friendship.friend} %>            
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
<% end %>

